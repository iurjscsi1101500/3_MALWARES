from scapy.all import *
import sys

if len(sys.argv) > 1:
    output_file = open(sys.argv[1], 'a')
else:
    print("Usage: python script.py output_file")
    sys.exit(1)

def main():
    interface = "en1"  # Replace with the appropriate interface on your Mac
    
    try:
        sniffer_socket = conf.L2listen(iface=interface)

        while True:
            packet = sniffer_socket.recv()
            if output_file:
                output_file.write(f'{packet.summary()}\n')

    except KeyboardInterrupt:
        output_file.close()
        print("\nSniffing stopped.")

if __name__ == "__main__":
    main()
